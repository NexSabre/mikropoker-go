var U=Object.defineProperty;var q=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var E=(r,t,n)=>t in r?U(r,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[t]=n,N=(r,t)=>{for(var n in t||(t={}))G.call(t,n)&&E(r,n,t[n]);if(q)for(var n of q(t))J.call(t,n)&&E(r,n,t[n]);return r};import{a as K,j as o,G as L,b as e,T as g,u as _,r as f,B as S,P as w,C as R,c as $,d as W,e as P,f as y,D as k,S as H,F as D,I as Y,g as z,M as Q,h as p,i as X,k as Z,l as ee,m as te,n as ne,L as M,o as T,p as re,q as se,s as A,t as ae,v as ie,w as oe,x as le,y as ce,z as ue,A as B,E as de,H as he,J as me,R as fe,K as pe,N as ge,O}from"./vendor.8be2a128.js";const be=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}};be();var F=K.create({baseURL:"http://localhost:8080",headers:{"Content-Type":"application/json"}}),v={async request(r,t,n={}){const i={"Content-Type":"application/json"};try{let s;switch(r){case"get":s=await F.get(encodeURI(t),{headers:i,params:n||{}});break;case"patch":s=await F.patch(encodeURI(t),n,{headers:i});break;case"post":s=await F.post(encodeURI(t),n,{headers:i});break;case"put":s=await F.put(encodeURI(t),n,{headers:i});break;case"delete":s=await F.delete(encodeURI(t),{headers:i});break;default:throw new Error("APIRequests: Unsupported Request Type")}return s}catch(s){return s.response}}};const C="/s";var I={async getHealth(){return await v.request("get","")},async getSession(r){return await v.request("get",`${C}/${r}`)},async getSessions(){return await v.request("get",C)},async postSession(r){return await v.request("post",C,r)},async postPoints(r,t){return await v.request("post",`${C}/${r}`,t)},async patchSession(r,t){return await v.request("patch",`${C}/${r}`,t)},async deleteAction(r){return await v.request("delete",`${C}/${r}`)}};function ve(){return o(L,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",style:{minHeight:"100vh"},children:[e(g,{variant:"h3",children:"\u{1F635}\u200D\u{1F4AB} Something wrong happened!"}),e(g,{variant:"body1",children:"but we've already sent a crew of specially trained squirrels to find out what happened! \u{1F43F}\uFE0F"})]})}function ye(){const r=_(),[t,n]=f.exports.useState(""),[i,s]=f.exports.useState(!1),[a,c]=f.exports.useState(!1);f.exports.useEffect(()=>{I.getHealth().then(l=>{l||c(!0)})});async function u(){if(!t)return null;await I.getSession(Number(t)).then(l=>{l&&l.status===200?r(`/room/${t}`):(n(""),s(!0))})}return o(L,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",style:{minHeight:"100vh"},children:[o(S,{children:[!a&&o(w,{sx:{minWidth:1e3,minHeight:600},elevation:0,children:[o(R,{elevation:6,children:[o($,{children:[e(g,{variant:"h5",children:"Go to the room \u{1F575}\uFE0F"}),e("br",{}),e(W,{label:"room id",variant:"standard",value:t,onChange:l=>{n(l.target.value)},fullWidth:!0})]}),e(P,{children:e(y,{variant:"contained",onClick:()=>{u()},disabled:!t,children:"GO!"})})]}),e("br",{}),e("br",{}),e(k,{children:"\u{1F446} or \u{1F447}"}),e("br",{}),e("br",{}),e(S,{textAlign:"center",children:e(y,{onClick:()=>r("/room"),children:"Create new one \u{1F929}"})})]}),a&&e(ve,{})]}),e(H,{sx:{position:"fixed",bottom:0,left:0,right:0},open:i,autoHideDuration:5e3,onClose:()=>s(!1),message:"Can not find a room \u{1F614} \u{1F6AB}"})]})}class xe extends f.exports.Component{constructor(t){super(t);this.state={}}async componentDidMount(){await I.getSessions().then(t=>{t&&this.setState({sessions:t.data})})}render(){return e("div",{className:"App",children:e(ye,{})})}}function Ce(){const[r,t]=f.exports.useState(""),[n,i]=f.exports.useState("10"),[s,a]=f.exports.useState(!1),c=_(),u=6e3,l=()=>{a(!0)},h=()=>{a(!1)};async function m(){let d={name:r};await I.postSession(d).then(b=>{b.status===404?l():b.status===201&&c(`/room/${b.data.id}`)}),h()}return e(L,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",style:{minHeight:"100vh"},children:o(S,{children:[e(w,{elevation:5,children:o(R,{sx:{maxWidth:600,mx:"auto"},children:[o($,{children:[e(g,{gutterBottom:!0,variant:"h5",children:"Create a new room"}),e(g,{variant:"body2",color:"text.secondary",children:"Provide a name for your room and the voting system."}),e(k,{}),e("div",{children:e(D,{fullWidth:!0,children:e(W,{sx:{maxWidth:600},id:"text-field-room-name",label:"Room name",variant:"standard",required:!0,fullWidth:!0,autoFocus:!0,onChange:d=>{t(d.target.value)}})})}),e("br",{}),e("div",{children:o(D,{fullWidth:!0,children:[e(Y,{id:"select-input-label",children:"Voting system"}),e(z,{labelId:"select-input-label",id:"select-input-voting",value:n,label:"Voting system",onChange:d=>i(d.target.value),variant:"standard",children:e(Q,{value:10,children:"Fibonacii (1, 2, 3, 5, 8, 13)"})})]})})]}),o(P,{children:[e(y,{size:"large",color:"primary",disabled:!r,onClick:m,children:"Create"}),e(y,{color:"secondary",onClick:()=>c("/"),children:"Cancel"})]})]})}),e(H,{open:s,autoHideDuration:u,onClose:()=>a(!1),message:"Can not create a session"})]})})}function Se(r){const{session_id:t,nickname:n,gws:i}=r,s=[0,1,2,3,5,8,13,21],a=u=>{r.gws.send(JSON.stringify({action:"salle",payload:[n,u].join(",")}))};return e(p,{children:e(()=>o(p,{children:[e("br",{}),e(X,{direction:"row",spacing:0,divider:e(k,{orientation:"vertical",flexItem:!0}),alignItems:"center",justifyContent:"center",children:s.map((u,l)=>e(y,{sx:{maxWidth:120},onClick:()=>a(u),children:u},l))})]}),{})})}function we(r){const{onClose:t,open:n}=r,[i,s]=f.exports.useState(""),a=(u,l)=>{l&&l=="backdropClick"||t(i)},c=u=>{t(u)};return o(Z,{onClose:a,open:n,sx:{maxWidth:"md",mx:"auto"},fullWidth:!0,disableEscapeKeyDown:!0,children:[e(ee,{children:"Who are you?"}),e(te,{children:e(W,{id:"standard-basic",label:"Your nickname \u{1F60E}",variant:"standard",onChange:u=>s(u.target.value.trim()),fullWidth:!0,autoFocus:!0})}),e(ne,{children:e(y,{onClick:()=>c(i),children:"GO!"})})]})}function ke(r){const{users:t,minimum:n,maximum:i}=r;let s=0,a=0;return t.forEach(c=>{(c.salle?c.salle:-1)>=0&&(s+=c.salle,a+=1)}),e(p,{children:a>0&&e(p,{children:n!==i&&o(p,{children:["\u{1F916} Avarage: ",e("b",{children:(s/a).toFixed(2)})]})})})}function Fe(r){if(!r.users)return null;const t=r.users,n=a(t),i=Math.min(...n),s=Math.max(...n);function a(l){return l.filter(h=>h).map(h=>h.salle?h.salle:-1).filter(h=>h>0)}function c(l,h){return l.filter(m=>m).map(m=>(m.salle?m.salle:-1)===h?m.username:"").filter(m=>m)}const u=()=>{if(!t)return null;let l=0,h=0,m,d;const b=a(t);return l=Math.min(...b),h=Math.max(...b),m=c(t,l),d=c(t,h),o(p,{children:[l!==h&&o(p,{children:["\u{1F4C8} max: ",e("b",{children:h}),e("br",{}),"\u2003(",d.join(","),")",e("br",{}),"\u{1F4C9} min:\xA0 ",e("b",{children:l}),e("br",{}),"\u2003(",m.join(","),")",e("br",{}),e("br",{}),e(S,{children:e(re,{getAriaLabel:()=>"Points range",value:[l,h],valueLabelDisplay:"auto",marks:t.map(x=>({value:x.salle?Number(x.salle):0,label:(x.salle?Number(x.salle):0).toString()})).filter(x=>x.value>0),disabled:!0,min:0,max:21})})]}),l===h&&o(p,{children:[" ","\u{1F44F} \u{1F64C} full consent for ",e("b",{children:l}),"!"]})]})};return o(w,{elevation:0,children:[a(t).length>0&&r.showValues&&o(M,{subheader:e(T,{children:"Statisitcs"}),children:[e(ke,{users:t,minimum:i,maximum:s}),e("br",{}),e(u,{})]}),a(t).length<=0&&e(p,{children:'Waiting for "your" score! \u{1F44A}'})]})}function Ie(r){const{reveal:t,session_id:n,ws:i}=r;async function s(c){await I.patchSession(Number(n),{reveal:c}),i.send(JSON.stringify({action:"reveal",payload:c}))}async function a(){await s(!1),i.send(JSON.stringify({action:"restart",payload:null}))}return e(w,{sx:{position:"fixed",bottom:0,left:0,right:0},elevation:3,children:o(se,{showLabels:!0,children:[e(A,{onClick:()=>{i.send("")},label:"Refresh",icon:e(ae,{})}),!t&&e(A,{onClick:()=>{s(!t)},label:"Show values",icon:e(ie,{})}),t&&e(A,{onClick:()=>{s(!t)},label:"Hide values",icon:e(oe,{})}),e(A,{onClick:()=>{a()},label:"Replay",icon:e(le,{})})]})})}function V(r){let t=0,n;for(n=0;n<r.length;n+=1)t=r.charCodeAt(n)+((t<<5)-t);let i="#";for(n=0;n<3;n+=1)i+=`00${(t>>n*8&255).toString(16)}`.slice(-2);return i}function Ne(r,t){const n=r.split(" "),i=n[0][0],s=()=>n.length>1?n[1][0]:"";return{sx:{bgcolor:V(t||"")},children:`${i} ${s()}`}}function j(r,t){return{sx:{bgcolor:V(t||"")},children:`${r}`}}function Ae(r){function t(n,i){return n!==i}return o(S,{children:[e(k,{}),e(M,{sx:{width:"100%",bgcolor:"background.paper"},subheader:e(T,{component:"div",id:"nested-list-subheader",children:"Participants"}),children:r.session.users&&r.session.users.map(n=>{if((n.salle?n.salle:-1)>=0)return o(ce,{alignItems:"flex-start",children:[o(ue,{children:[r.showValues&&e(B,N({},j(n.salle,n.username))),!r.showValues&&(t(n.username,r.nickname)?e(B,N({},Ne("#",n.username))):e(B,N({},j(n.salle,n.username))))]}),e(de,{primary:e(f.exports.Fragment,{children:e(g,{sx:{display:"inline"},variant:"h5",children:o(g,{variant:"body1",children:[n.username," ",n.username===r.nickname&&e(g,{variant:"body2",children:"(You)"})]})})})})]},n.id)})})]})}function Re(r){const{nickname:t,session_name:n,room_id:i}=r;return o(w,{sx:{position:"fixed",top:10,left:10,right:0},elevation:0,children:["Welcome back, ",e("b",{children:t})," @ Session ",e("b",{children:n})," (#",i,")",e(k,{})]})}function $e(){let r=he();const[t,n]=f.exports.useState(!1),[i,s]=f.exports.useState(""),[a,c]=f.exports.useState({id:0,name:"",reveal:!1,users:[]}),[u]=f.exports.useState(new WebSocket(`ws://localhost:8080/ws/${r.roomId}`)),l=d=>{n(!1),s(d),sessionStorage.setItem("nickname",d)},h=()=>{u.onopen=()=>{u.send(i||"")},u.onmessage=d=>{const b=JSON.parse(d.data);c(b)}},m=()=>a.users?a.users.filter(d=>(d.salle?d.salle:0)>0).length:0;return f.exports.useEffect(()=>{const d=sessionStorage.getItem("nickname");return d?s(d):!d&&!i&&n(!0),h(),()=>{}},["nickname"]),o(p,{children:[e(Re,{nickname:i,session_name:a.name,room_id:r.roomId}),o(L,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",style:{minHeight:"100vh"},children:[o(S,{sx:{maxWidth:1e3},alignContent:"center",justifyContent:"center",children:[o(w,{sx:{mx:"auto"},elevation:0,children:[o(R,{elevation:0,children:[o($,{children:[a.users&&e(Fe,{users:a.users,showValues:a.reveal}),!a.reveal&&o(g,{variant:"body2",children:[m()==1?`\u{1F4EB} ${m()} response is hidden, `:" ",m()>1?`\u{1F4EB} ${m()} responses are hidden, `:" ","waiting for reveal... \u231B"," "]})]}),e(P,{children:e(y,{onClick:()=>{u.send("")},children:"refresh"})})]}),e("br",{}),e(R,{elevation:0,children:e($,{children:e(Ae,{nickname:i,showValues:a.reveal,session:a})})})]}),e(k,{}),e(Se,{session_id:r.roomId,nickname:i,gws:u})]}),e(we,{open:t,onClose:l})]}),e(Ie,{session_id:r.roomId,reveal:a.reveal,ws:u})]})}const Le=document.getElementById("root"),Be=me(Le);Be.render(e(fe.StrictMode,{children:e(pe,{children:o(ge,{children:[e(O,{path:"/",element:e(xe,{})}),e(O,{path:"room",element:e(Ce,{})}),e(O,{path:"room/:roomId",element:e($e,{})})]})})}));
