var U=Object.defineProperty;var q=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var E=(s,t,n)=>t in s?U(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n,N=(s,t)=>{for(var n in t||(t={}))G.call(t,n)&&E(s,n,t[n]);if(q)for(var n of q(t))J.call(t,n)&&E(s,n,t[n]);return s};import{a as K,u as _,r as f,j as o,G as W,B as y,P as w,C as R,b as $,c as e,T as v,d as B,e as P,f as x,D as k,S as H,F as j,I as Y,g as z,M as Q,h as g,i as X,k as Z,l as ee,m as te,n as ne,L as M,o as T,p as se,q as re,s as A,t as ae,v as ie,w as oe,x as le,y as ce,z as ue,A as L,E as de,H as he,J as me,R as fe,K as pe,N as ge,O}from"./vendor.b8856755.js";const be=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}};be();var I=K.create({baseURL:"",headers:{"Content-Type":"application/json"}}),b={async request(s,t,n={}){const i={"Content-Type":"application/json"};try{let r;switch(s){case"get":r=await I.get(encodeURI(t),{headers:i,params:n||{}});break;case"patch":r=await I.patch(encodeURI(t),n,{headers:i});break;case"post":r=await I.post(encodeURI(t),n,{headers:i});break;case"put":r=await I.put(encodeURI(t),n,{headers:i});break;case"delete":r=await I.delete(encodeURI(t),{headers:i});break;default:throw new Error("APIRequests: Unsupported Request Type")}return r}catch(r){return r.response}}};const S="/s";var F={async getHealth(){return await b.request("get","")},getPort(){return b.request("get","port")},async getSession(s){return await b.request("get",`${S}/${s}`)},async getSessions(){return await b.request("get",S)},async postSession(s){return await b.request("post",S,s)},async postPoints(s,t){return await b.request("post",`${S}/${s}`,t)},async patchSession(s,t){return await b.request("patch",`${S}/${s}`,t)},async deleteAction(s){return await b.request("delete",`${S}/${s}`)}};function ve(){const s=_(),[t,n]=f.exports.useState(""),[i,r]=f.exports.useState(!1),[a,c]=f.exports.useState(!1);f.exports.useEffect(()=>{F.getHealth().then(l=>{l||c(!0)})});async function u(){if(!t)return null;await F.getSession(Number(t)).then(l=>{l&&l.status===200?s(`/room/${t}`):(n(""),r(!0))})}return o(W,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",style:{minHeight:"100vh"},children:[o(y,{children:[o(w,{sx:{minWidth:1e3,minHeight:600},elevation:0,children:[o(R,{elevation:6,children:[o($,{children:[e(v,{variant:"h5",children:"Go to the room \u{1F575}\uFE0F"}),e("br",{}),e(B,{label:"room id",variant:"standard",value:t,onChange:l=>{n(l.target.value)},fullWidth:!0})]}),e(P,{children:e(x,{variant:"contained",onClick:()=>{u()},disabled:!t,children:"GO!"})})]}),e("br",{}),e("br",{}),e(k,{children:"\u{1F446} or \u{1F447}"}),e("br",{}),e("br",{}),e(y,{textAlign:"center",children:e(x,{onClick:()=>s("/room"),children:"Create new one \u{1F929}"})})]}),")"]}),e(H,{sx:{position:"fixed",bottom:0,left:0,right:0},open:i,autoHideDuration:5e3,onClose:()=>r(!1),message:"Can not find a room \u{1F614} \u{1F6AB}"})]})}class xe extends f.exports.Component{constructor(t){super(t);this.state={}}async componentDidMount(){await F.getSessions().then(t=>{t&&this.setState({sessions:t.data})})}render(){return e("div",{className:"App",children:e(ve,{})})}}function Ce(){const[s,t]=f.exports.useState(""),[n,i]=f.exports.useState("10"),[r,a]=f.exports.useState(!1),c=_(),u=6e3,l=()=>{a(!0)},h=()=>{a(!1)};async function m(){let d={name:s};await F.postSession(d).then(p=>{p.status===404?l():p.status===201&&c(`/room/${p.data.id}`)}),h()}return e(W,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",style:{minHeight:"100vh"},children:o(y,{children:[e(w,{elevation:5,children:o(R,{sx:{maxWidth:600,mx:"auto"},children:[o($,{children:[e(v,{gutterBottom:!0,variant:"h5",children:"Create a new room"}),e(v,{variant:"body2",color:"text.secondary",children:"Provide a name for your room and the voting system."}),e(k,{}),e("div",{children:e(j,{fullWidth:!0,children:e(B,{sx:{maxWidth:600},id:"text-field-room-name",label:"Room name",variant:"standard",required:!0,fullWidth:!0,autoFocus:!0,onChange:d=>{t(d.target.value)}})})}),e("br",{}),e("div",{children:o(j,{fullWidth:!0,children:[e(Y,{id:"select-input-label",children:"Voting system"}),e(z,{labelId:"select-input-label",id:"select-input-voting",value:n,label:"Voting system",onChange:d=>i(d.target.value),variant:"standard",children:e(Q,{value:10,children:"Fibonacii (1, 2, 3, 5, 8, 13)"})})]})})]}),o(P,{children:[e(x,{size:"large",color:"primary",disabled:!s,onClick:m,children:"Create"}),e(x,{color:"secondary",onClick:()=>c("/"),children:"Cancel"})]})]})}),e(H,{open:r,autoHideDuration:u,onClose:()=>a(!1),message:"Can not create a session"})]})})}function Se(s){const{session_id:t,nickname:n,gws:i}=s,r=[0,1,2,3,5,8,13,21],a=u=>{s.gws.send(JSON.stringify({action:"salle",payload:[n,u].join(",")}))};return e(g,{children:e(()=>o(g,{children:[e("br",{}),e(X,{direction:"row",spacing:0,divider:e(k,{orientation:"vertical",flexItem:!0}),alignItems:"center",justifyContent:"center",children:r.map((u,l)=>e(x,{sx:{maxWidth:120},onClick:()=>a(u),children:u},l))})]}),{})})}function ye(s){const{onClose:t,open:n}=s,[i,r]=f.exports.useState(""),a=(u,l)=>{l&&l=="backdropClick"||t(i)},c=u=>{t(u)};return o(Z,{onClose:a,open:n,sx:{maxWidth:"md",mx:"auto"},fullWidth:!0,disableEscapeKeyDown:!0,children:[e(ee,{children:"Who are you?"}),e(te,{children:e(B,{id:"standard-basic",label:"Your nickname \u{1F60E}",variant:"standard",onChange:u=>r(u.target.value.trim()),fullWidth:!0,autoFocus:!0})}),e(ne,{children:e(x,{onClick:()=>c(i),children:"GO!"})})]})}function we(s){const{users:t,minimum:n,maximum:i}=s;let r=0,a=0;return t.forEach(c=>{(c.salle?c.salle:-1)>=0&&(r+=c.salle,a+=1)}),e(g,{children:a>0&&e(g,{children:n!==i&&o(g,{children:["\u{1F916} Avarage: ",e("b",{children:(r/a).toFixed(2)})]})})})}function ke(s){if(!s.users)return null;const t=s.users,n=a(t),i=Math.min(...n),r=Math.max(...n);function a(l){return l.filter(h=>h).map(h=>h.salle?h.salle:-1).filter(h=>h>0)}function c(l,h){return l.filter(m=>m).map(m=>(m.salle?m.salle:-1)===h?m.username:"").filter(m=>m)}const u=()=>{if(!t)return null;let l=0,h=0,m,d;const p=a(t);return l=Math.min(...p),h=Math.max(...p),m=c(t,l),d=c(t,h),o(g,{children:[l!==h&&o(g,{children:["\u{1F4C8} max: ",e("b",{children:h}),e("br",{}),"\u2003(",d.join(","),")",e("br",{}),"\u{1F4C9} min:\xA0 ",e("b",{children:l}),e("br",{}),"\u2003(",m.join(","),")",e("br",{}),e("br",{}),e(y,{children:e(se,{getAriaLabel:()=>"Points range",value:[l,h],valueLabelDisplay:"auto",marks:t.map(C=>({value:C.salle?Number(C.salle):0,label:(C.salle?Number(C.salle):0).toString()})).filter(C=>C.value>0),disabled:!0,min:0,max:21})})]}),l===h&&o(g,{children:[" ","\u{1F44F} \u{1F64C} full consent for ",e("b",{children:l}),"!"]})]})};return o(w,{elevation:0,children:[a(t).length>0&&s.showValues&&o(M,{subheader:e(T,{children:"Statisitcs"}),children:[e(we,{users:t,minimum:i,maximum:r}),e("br",{}),e(u,{})]}),a(t).length<=0&&e(g,{children:'Waiting for "your" score! \u{1F44A}'})]})}function Ie(s){const{reveal:t,session_id:n,ws:i}=s;async function r(c){await F.patchSession(Number(n),{reveal:c}),i.send(JSON.stringify({action:"reveal",payload:c}))}async function a(){await r(!1),i.send(JSON.stringify({action:"restart",payload:null}))}return e(w,{sx:{position:"fixed",bottom:0,left:0,right:0},elevation:3,children:o(re,{showLabels:!0,children:[e(A,{onClick:()=>{i.send("")},label:"Refresh",icon:e(ae,{})}),!t&&e(A,{onClick:()=>{r(!t)},label:"Show values",icon:e(ie,{})}),t&&e(A,{onClick:()=>{r(!t)},label:"Hide values",icon:e(oe,{})}),e(A,{onClick:()=>{a()},label:"Replay",icon:e(le,{})})]})})}function V(s){let t=0,n;for(n=0;n<s.length;n+=1)t=s.charCodeAt(n)+((t<<5)-t);let i="#";for(n=0;n<3;n+=1)i+=`00${(t>>n*8&255).toString(16)}`.slice(-2);return i}function Fe(s,t){const n=s.split(" "),i=n[0][0],r=()=>n.length>1?n[1][0]:"";return{sx:{bgcolor:V(t||"")},children:`${i} ${r()}`}}function D(s,t){return{sx:{bgcolor:V(t||"")},children:`${s}`}}function Ne(s){function t(n,i){return n!==i}return o(y,{children:[e(k,{}),e(M,{sx:{width:"100%",bgcolor:"background.paper"},subheader:e(T,{component:"div",id:"nested-list-subheader",children:"Participants"}),children:s.session.users&&s.session.users.map(n=>{if((n.salle?n.salle:-1)>=0)return o(ce,{alignItems:"flex-start",children:[o(ue,{children:[s.showValues&&e(L,N({},D(n.salle,n.username))),!s.showValues&&(t(n.username,s.nickname)?e(L,N({},Fe("#",n.username))):e(L,N({},D(n.salle,n.username))))]}),e(de,{primary:e(f.exports.Fragment,{children:e(v,{sx:{display:"inline"},variant:"h5",children:o(v,{variant:"body1",children:[n.username," ",n.username===s.nickname&&e(v,{variant:"body2",children:"(You)"})]})})})})]},n.id)})})]})}function Ae(s){const{nickname:t,session_name:n,room_id:i}=s;return o(w,{sx:{position:"fixed",top:10,left:10,right:0},elevation:0,children:["Welcome back, ",e("b",{children:t})," @ Session ",e("b",{children:n})," (#",i,")",e(k,{})]})}function Re(){let s=he();const[t,n]=f.exports.useState(!1),[i,r]=f.exports.useState(""),[a,c]=f.exports.useState({id:0,name:"",reveal:!1,users:[]});f.exports.useState();const[u]=f.exports.useState(()=>{const d=fetch("/port").then(p=>p.json()).then(p=>p.port);return new WebSocket(`ws://localhost${d}/ws/${s.roomId}`,"ws")}),l=d=>{n(!1),r(d),sessionStorage.setItem("nickname",d)},h=()=>{u.onopen=()=>{u.send(i||"")},u.onmessage=d=>{const p=JSON.parse(d.data);c(p)}},m=()=>a.users?a.users.filter(d=>(d.salle?d.salle:0)>0).length:0;return f.exports.useEffect(()=>{const d=sessionStorage.getItem("nickname");return d?r(d):!d&&!i&&n(!0),h(),()=>{}},["nickname"]),o(g,{children:[e(Ae,{nickname:i,session_name:a.name,room_id:s.roomId}),o(W,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",style:{minHeight:"100vh"},children:[o(y,{sx:{maxWidth:1e3},alignContent:"center",justifyContent:"center",children:[o(w,{sx:{mx:"auto"},elevation:0,children:[o(R,{elevation:0,children:[o($,{children:[a.users&&e(ke,{users:a.users,showValues:a.reveal}),!a.reveal&&o(v,{variant:"body2",children:[m()==1?`\u{1F4EB} ${m()} response is hidden, `:" ",m()>1?`\u{1F4EB} ${m()} responses are hidden, `:" ","waiting for reveal... \u231B"," "]})]}),e(P,{children:e(x,{onClick:()=>{u.send("")},children:"refresh"})})]}),e("br",{}),e(R,{elevation:0,children:e($,{children:e(Ne,{nickname:i,showValues:a.reveal,session:a})})})]}),e(k,{}),e(Se,{session_id:s.roomId,nickname:i,gws:u})]}),e(ye,{open:t,onClose:l})]}),e(Ie,{session_id:s.roomId,reveal:a.reveal,ws:u})]})}const $e=document.getElementById("root"),Le=me($e);Le.render(e(fe.StrictMode,{children:e(pe,{children:o(ge,{children:[e(O,{path:"/",element:e(xe,{})}),e(O,{path:"room",element:e(Ce,{})}),e(O,{path:"room/:roomId",element:e(Re,{})})]})})}));
